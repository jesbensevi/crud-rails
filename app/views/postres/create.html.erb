<div class="container">
<form method="POST" action="/postres/insert" accept-charset="UTF-8" role="form" id="crearpostre" name="crearpostre" enctype="multipart/form-data">
    
    <!-- Protecci칩n CSRF -->
    <%= token_tag nil %>
 
    <div class="row">
        <div class="col-md-12">
            <section class="panel">
                <div class="panel-body">
 
                    <div class="form-group">
                        <label for="nombre" class="negrita">Nombre:</label>
                        <div>
                            <input class="form-control" placeholder="Torta de Chocolate" name="nombre" type="text" id="nombre" onload="crearUrlAmigable(this.value);" onkeypress="crearUrlAmigable(this.value);" required>
                        </div>
                    </div>
 
                    <div class="form-group">
                        <label for="precio" class="negrita">Precio:</label>
                        <div>
                            <input class="form-control" placeholder="4.50" name="precio" type="text" id="precio" required>
                        </div>
                    </div>
 
                    <div class="form-group">
                        <label for="stock" class="negrita">Stock:</label>
                        <div>
                            <input class="form-control" placeholder="40" name="stock" type="text" id="stock" required>
                        </div>
                    </div>
 
                    <div class="form-group">
                        <label for="img" class="negrita">Selecciona una imagen:</label>
                        <div>
                             <input class="form-control" type="file" name="nimg" id="nimg" onchange="cargarImagen()" required>
                        </div>
                    </div>
 


                    <div class="form-group">
                        <label for="url" class="negrita">URL:</label>
                        <div>
                            <input type="text" class="form-control" name="url" id="url" readonly>
                            <input type="text" class="form-control" name="img" id="img" readonly hidden>
                        </div>
                    </div>
 
                    <button type="submit" class="btn btn-info">Guardar</button>
                    <%= link_to 'Cancelar', url_for(:back), class: "btn btn-warning" %>
 
                        <br>
                        <br>
 
                </div>
            </section>
        </div>
    </div>
</form>
</div>

<script>
function crearUrlAmigable(str) {
 
    // Reemplaza los car치cteres especiales | simbolos con un espacio 
    str = str.replace(/[`~!@#$%^&*()_\-+=\[\]{};:'"\\|\/,.<>?\s]/g, ' ').toLowerCase();
 
    // Corta los espacios al inicio y al final del string
    str = str.replace(/^\s+|\s+$/gm, '');
 
    // Reemplaza el espacio con gui칩n 
    str = str.replace(/\s+/g, '-');
 
    var input = document.getElementById('url');
    input.value = str;
 
}

    function cargarImagen() {
 
    var name = document.getElementById('nimg');
    //alert('Nombre: ' + name.files.item(0).name);
    //alert('Tama침o: ' + name.files.item(0).size);
    //alert('Tipo: ' + name.files.item(0).type)
 
    nas = name.files.item(0).name
 
    var ini = document.getElementById('img');
 
    ini.value = nas;
 
}
</script>